<div class="container">
  <div class="container d-flex justify-content-around mx-auto mt-5">
    <div class="container">
      <h2><%= @colony.name %></h2>
    </div>
    <div class="container d-flex justify-content-end">
      <% if policy(@colony).update? %>
        <%= link_to 'Edit', edit_colony_path(@colony), class: "btn btn-primary" %>
      <% end %>
      <% if policy(@association).create? %>
        <%= simple_form_for [@colony, @association] do |f| %>
          <%= f.submit 'Join', class: "btn btn-primary" %>
        <% end %>
      <% end %>
      <% if policy(@association).destroy? %>
        <%= link_to 'Leave', association_path(@association), method: :delete, data: { confirm: 'Leave this group?'}, class: "btn btn-primary mx-1" %>
      <% end %>
      <% if policy(@colony).destroy? %>
        <%= link_to 'Delete', colony_path(@colony), method: :delete, data: { confirm: 'Permanently delete this colony?' }, class: "btn btn-danger" %>
      <% end %>
    </div>
  </div>
  <div class="grid-container m-4">
    <div class="column p-4" style="background-color: white; border-radius: 10px">
      <h4 class="mb-4">About this colony</h4>
      <div class="content p-3" style="background-color: #f7f5e6; border-radius: 10px;">
        <p>Founded: <%= @colony.created_at.strftime("%-d %B %Y") %></p>
        <p><%= @colony.description %></p>
        <p>Admin: <%= @colony.admins.map { |admin| admin.full_name }.join(', ') %></p>
        <p>Cats (<%= @colony.cats.length %>)</p>
        <p>Members (<%= @colony.users.length %>)</p>
      </div>

    <!-- member section -->

      <div class="d-flex justify-content-between mt-5 mb-3">
        <div class="content">
          <h4>Members</h4>
        </div>
      </div>
      <div class="content p-3" style="background-color: #f7f5e6; border-radius: 10px;">
        <% @colony.users.each do |user| %>
          <p><%= link_to user.full_name, user_path(user) %></p>
        <% end %>
      </div>

    <!-- cat section -->

      <div class="d-flex justify-content-between mt-5 mb-3">
        <div class="content">
          <h4>Cats</h4>
        </div>
        <div class="content">
          <% if policy(@cat).create? %>
            <%= link_to '+ Add a cat', new_colony_cat_path(@colony), class: "btn btn-success" %>
          <% end %>
        </div>
     </div>
       <div class="content p-3" style="background-color: #f7f5e6; border-radius: 10px;">
        <% @colony.cats.each do |cat| %>
          <%= image_tag cat.photo.url(:thumbnail), class: 'rounded' %>
          <p><%= link_to cat.name, cat_path(cat) %></p>
          <p><%= cat.status %></p>
        <% end %>
      </div>
    </div>


    <div class="column p-4" style="background-color: white; border-radius: 10px">
      <div class="d-flex justify-content-between">
        <div class="content">
          <h4>Events</h4>
        </div>
        <div class="content">
          <% if policy(@event).create? %>
            <%= link_to '+ Create new event', new_colony_event_path(@colony), class: "btn btn-success" %>
          <% end %>
        </div>
      </div>

     <!--  event list -->

      <% @colony.events.each do |event| %>
        <div class="card join-card my-5" style="width: 30em; background-color: #fcf5f4;">
          <div class="card-body">
            <h4 class="card-title"> <%=event.title %> </h4>
            <h5 class="card-subtitle"> <%=event.start.strftime("%-d %B %Y") %> to <%=event.end.strftime("%-d %B %Y") %> </h5>
            <p class="card-text"><%=event.description %></p>
            <%= link_to "Join", event_path(event), class: "btn btn-success btn-round" %>
          </div>
        </div>
      <% end %>

    </div>
  </div>
</div>
